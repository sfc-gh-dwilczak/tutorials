<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../aws/kinesis/">
      
      
        <link rel="next" href="../sso/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21+insiders-4.53.17">
    
    
      
        <title>Blob / Storage - Daniel Wilczak - Tutorials</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7d528353.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2VSMCC57YV"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2VSMCC57YV",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2VSMCC57YV",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#connect-snowflake-to-azure-storage" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Daniel Wilczak - Tutorials" class="md-header__button md-logo" aria-label="Daniel Wilczak - Tutorials" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Daniel Wilczak - Tutorials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
                Blob / Storage
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sfc-gh-dwilczak/tutorials/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Daniel Wilczak - Tutorials" class="md-nav__button md-logo" aria-label="Daniel Wilczak - Tutorials" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    Daniel Wilczak - Tutorials
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sfc-gh-dwilczak/tutorials/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    <span class="md-typeset">
      Introduction
    </span>
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clouds
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     AWS
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
     AWS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/s3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      S3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/kinesis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Kinesis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Azure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
     Azure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
      Blob / Storage
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
      Blob / Storage
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Requirements
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#video" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Video
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Download  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span>
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Manual Loading  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span>
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Loading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Azure
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Azure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-storage-account" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Create Storage account
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-container" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Create Container
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-sample-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Upload sample data
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-teanent-id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Get teanent ID
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snowflake" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Snowflake
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Snowflake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grant-access-in-azure" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Grant Access in Azure
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Load the data
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Automatic Loading  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span>
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automatic Loading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Azure
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snowflake_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Snowflake
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Snowflake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grant-access-in-azure_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Grant Access in Azure
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-the-data_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Load the data
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Result
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Active Directory / SSO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      SCIM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Google Cloud
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
     Google Cloud
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../google/storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Cloud Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../google/external/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      External Tables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../google/fivetran/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Fivetran Data Lake
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../google/iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../google/sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      SSO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configurations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7">
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Account
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
     Account
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/account/add/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Add account to Org
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/account/service_level/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Change Service Level
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/account/name/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Org / Account name
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/account/replication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Replication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/account/support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Support Ticket
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8">
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
     Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/security/key_pair/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Key Pair Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/security/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Python with Key Pair
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configurations/security/network_policy/user/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Network Policy - User
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Sharing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sharing/direct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
     Direct
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sharing/listing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
     Listings
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Science / ML
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../science/analyst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
     Cortex Analyst
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14">
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            
  
     Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../science/models/registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Registry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15">
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Notebooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            
  
     Notebooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../science/notebooks/containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Intro to Containerized
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../science/notebooks/jupyter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Intro to Local Jupyter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Engineering
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17">
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     API's
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            
  
     API's
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/api/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Intoduction via Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/api/chatgpt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Chatgpt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18">
        
          
          <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Documents
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_18">
            <span class="md-nav__icon md-icon"></span>
            
  
     Documents
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/documents/ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Document AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_19">
        
          
          <label class="md-nav__link" for="__nav_19" id="__nav_19_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Tasks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_19">
            <span class="md-nav__icon md-icon"></span>
            
  
     Tasks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/tasks/lineage/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Lineage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_20">
        
          
          <label class="md-nav__link" for="__nav_20" id="__nav_20_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     SFTP
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_20">
            <span class="md-nav__icon md-icon"></span>
            
  
     SFTP
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/sftp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Via Notebook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Openflow
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_22">
        
          
          <label class="md-nav__link" for="__nav_22" id="__nav_22_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Deployment
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_22">
            <span class="md-nav__icon md-icon"></span>
            
  
     Deployment
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/openflow/deployments/spcs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      SPCS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/openflow/deployments/byoc_snowflake_vpc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      BYOC with Snowflake VPC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_23">
        
          
          <label class="md-nav__link" for="__nav_23" id="__nav_23_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Connectors
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_23">
            <span class="md-nav__icon md-icon"></span>
            
  
     Connectors
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../engineering/openflow/connectors/google_sheets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Google Sheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/dbt/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
     DBT
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_26">
        
          
          <label class="md-nav__link" for="__nav_26" id="__nav_26_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Fivetran
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_26_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_26">
            <span class="md-nav__icon md-icon"></span>
            
  
     Fivetran
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/fivetran/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_26_2">
        
          
          <label class="md-nav__link" for="__nav_26_2" id="__nav_26_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
      Sources
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_26_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_26_2">
            <span class="md-nav__icon md-icon"></span>
            
  
      Sources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/fivetran/sources/google_analytics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
       Google Analytics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
     Git
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_28">
        
          
          <label class="md-nav__link" for="__nav_28" id="__nav_28_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Tableau
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_28_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_28">
            <span class="md-nav__icon md-icon"></span>
            
  
     Tableau
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/tableau/key_pair/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Key Pair
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/tableau/oauth_snowflake/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      OAuth - Snowflake
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/zapier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
     Zapier
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="#" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Apps
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_31">
        
          
          <label class="md-nav__link" for="__nav_31" id="__nav_31_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Container Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_31_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_31">
            <span class="md-nav__icon md-icon"></span>
            
  
     Container Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../apps/container/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../apps/container/streamlit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Streamlit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_32">
        
          
          <label class="md-nav__link" for="__nav_32" id="__nav_32_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
     Native App
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_32_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_32">
            <span class="md-nav__icon md-icon"></span>
            
  
     Native App
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../apps/native/containers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Container Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../apps/native/traditional/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
      Traditional
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Requirements
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#video" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Video
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Download  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span>
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manual-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Manual Loading  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span>
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Manual Loading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Azure
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Azure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-storage-account" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Create Storage account
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-container" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Create Container
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upload-sample-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Upload sample data
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-teanent-id" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Get teanent ID
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snowflake" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Snowflake
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Snowflake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grant-access-in-azure" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Grant Access in Azure
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Load the data
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#automatic-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Automatic Loading  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span>
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Automatic Loading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Azure
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snowflake_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Snowflake
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Snowflake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grant-access-in-azure_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Grant Access in Azure
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-the-data_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Load the data
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#result" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Result
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/sfc-gh-dwilczak/tutorials/edit/main/docs/clouds/azure/storage/index.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/sfc-gh-dwilczak/tutorials/raw/main/docs/clouds/azure/storage/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
    </a>
  


<h1 id="connect-snowflake-to-azure-storage">Connect Snowflake to Azure Storage</h1>
<p>Goal of this tutorial is to load JSON and CSV data from a Azure Storage using the <a href="https://docs.snowflake.com/en/sql-reference/sql/copy-into-table">Copy into</a> sql command and <a href="https://docs.snowflake.com/en/user-guide/data-load-snowpipe-intro">Snowpipe</a> to automate the ingestion process.</p>
<h2 id="requirements">Requirements</h2>
<ul>
<li>Snowflake account, you can use a <a href="https://signup.snowflake.com/">free trial</a>. We also assume no complex security needs.</li>
<li>Azure account, you can setup a <a href="https://azure.microsoft.com/en-us/free/">free account</a> to get started.</li>
</ul>
<h2 id="video">Video</h2>
<iframe width="850px" height="478px" src="https://www.youtube.com/embed/K18izJ1azFg?si=QloTQIiHYYOoumxm" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

<h2 id="download">Download  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span></h2>
<ul>
<li>Sample data (<a href="https://sfc-gh-dwilczak.github.io/tutorials/data/data.zip">Link</a>)</li>
</ul>
<h2 id="manual-loading">Manual Loading  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span></h2>
<p>Lets start by setting up a Snowflake connection to Azure storage and load json data. After that use snowpipe to automate the ingestion of CSV files.</p>
<h3 id="azure">Azure</h3>
<p>Sign into your azure account.</p>
<h4 id="create-storage-account">Create Storage account</h4>
<p>Create the stoage account you intend to use. 
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/1.png" data-desc-position="bottom"><img alt="Azure create container" src="images/1.png"></a></p>
<p>In our case we'll call the stoage account <strong>danielwilczak</strong> and make it's region the same as the one our Snowflake account. It's okay if it's not with the same provider or region, it's just the quickest. We will also use the default for everything else. If creating a resource group just enter a name and take the defaults.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/2.png" data-desc-position="bottom"><img alt="Azure create container options" src="images/2.png"></a></p>
<p>We will then navigate into the storage account.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/3.png" data-desc-position="bottom"><img alt="Navigate into storage account" src="images/3.png"></a></p>
<h4 id="create-container">Create Container</h4>
<p>Create a storage container. 
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/4.png" data-desc-position="bottom"><img alt="Click create container" src="images/4.png"></a></p>
<p>In our case we will call it <strong>data</strong>.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/5.png" data-desc-position="bottom"><img alt="Container name" src="images/5.png"></a></p>
<p>Navigate into the data container.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/6.png" data-desc-position="bottom"><img alt="Navigate into container" src="images/6.png"></a></p>
<h4 id="upload-sample-data">Upload sample data</h4>
<p>Lets upload some sample data
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/7.png" data-desc-position="bottom"><img alt="Navigate into container" src="images/7.png"></a></p>
<p>Upload the <a href="https://sfc-gh-dwilczak.github.io/tutorials/data/data.zip">sample data</a> to your azure storage bucket (json/csv) provided in the data folder.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/33.gif" data-desc-position="bottom"><img alt="Upload example data" src="images/33.gif"></a></p>
<h4 id="get-teanent-id">Get teanent ID</h4>
<p>Using the search bar, look up <strong>tenant properties</strong>.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/9.png" data-desc-position="bottom"><img alt="Tenant Properties" src="images/9.png"></a></p>
<p>Copy your <strong>Tenant ID</strong>. We will use this in two places.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/10.png" data-desc-position="bottom"><img alt="Tenant Properties" src="images/10.png"></a></p>
<h3 id="snowflake">Snowflake</h3>
<p class="annotate">Let's transition to Snowflake by creating a worksheet (1) and adding the code below with your information:</p>
<ol>
<li><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/00.png" data-desc-position="bottom"><img alt="Worksheet" src="images/00.png"></a></li>
</ol>
<details class="note">
<summary>If you don't have a database, schema or warehouse yet.</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Database, schema and warehouse</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="w"> </span><span class="cm">/*</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="cm">We switch to "sysadmin" to create an object</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="cm">because it will be owned by that role.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="cm">*/</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="c1">-- Create a database to store our schemas.</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">create</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">raw</span><span class="w"> </span><span class="p">;</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="c1">-- Create the schema. The schema stores all objects.</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">create</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">raw</span><span class="p">.</span><span class="n">azure</span><span class="p">;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="cm">/*</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="cm">Warehouses are synonymous with the idea of</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="cm">compute resources in other systems.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="cm">*/</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">create</span><span class="w"> </span><span class="n">warehouse</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">development</span><span class="w"> </span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="n">warehouse_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xsmall</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="n">auto_suspend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="n">initially_suspended</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="n">use</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">raw</span><span class="p">;</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="n">use</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="n">azure</span><span class="p">;</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="n">use</span><span class="w"> </span><span class="n">warehouse</span><span class="w"> </span><span class="n">development</span><span class="p">;</span>
</code></pre></div></td></tr></tbody></table></div>
</div>
</div>
</div>
</details>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><input id="__tabbed_2_3" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Template</label><label for="__tabbed_2_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Example</label><label for="__tabbed_2_3"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2 2.75C2 1.784 2.784 1 3.75 1h2.5a.75.75 0 0 1 0 1.5h-2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 0 1.5h-2.5A1.75 1.75 0 0 1 2 13.25Zm10.44 4.5-1.97-1.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l3.25 3.25a.75.75 0 0 1 0 1.06l-3.25 3.25a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734l1.97-1.97H6.75a.75.75 0 0 1 0-1.5Z"></path></svg></span> Result</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p class="annotate"></p><div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="cm">/*</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="cm">Integrations are on of those important features that account admins</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="cm">should do because it's allowing outside snowflake connections to your data.</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="cm">*/</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">accountadmin</span><span class="p">;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">storage</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_integration</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">external_stage</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="n">storage_provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'azure'</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">    </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">    </span><span class="n">azure_tenant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;TENANT_ID&gt;'</span><span class="w"> </span><span class="cm">/* (1)! */</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">        </span><span class="n">storage_allowed_locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="s1">'azure://&lt;STORAGE ACCOUNT NAME&gt;.blob.core.windows.net/&lt;CONTAINER NAME&gt;'</span><span class="w"> </span><span class="cm">/* (2)! */</span><span class="w"> </span><span class="cm">/* (3)! */</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><span class="c1">-- Give the sysadmin access to use the integration later.</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><span class="k">grant</span><span class="w"> </span><span class="k">usage</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_integration</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><span class="c1">-- Get the URL to authenticate with azure and the app name to use later.</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><span class="k">describe</span><span class="w"> </span><span class="k">storage</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_integration</span><span class="p">;</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><span class="k">select</span><span class="w"> </span><span class="ss">"property"</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><span class="k">case</span><span class="w">  </span><span class="k">when</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="ss">"property_value"</span><span class="p">,</span><span class="w"> </span><span class="s1">'_'</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">"property_value"</span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"property_value"</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><span class="k">from</span><span class="w"> </span><span class="k">table</span><span class="p">(</span><span class="n">result_scan</span><span class="p">(</span><span class="n">last_query_id</span><span class="p">()))</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><span class="k">where</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'AZURE_CONSENT_URL'</span><span class="p">,</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="p">);</span>
</code></pre></div></td></tr></tbody></table></div><p></p>
<ol>
<li>
<p>Using the search bar, look up <strong>tenant properties</strong>.
    <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/9.png" data-desc-position="bottom"><img alt="Tenant Properties" src="images/9.png"></a></p>
<p>Copy your <strong>Tenant ID</strong>.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/10.png" data-desc-position="bottom"><img alt="Tenant Properties" src="images/10.png"></a></p>
</li>
<li>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/3.png" data-desc-position="bottom"><img alt="Navigate into storage account" src="images/3.png"></a></p>
</li>
<li>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/6.png" data-desc-position="bottom"><img alt="Navigate into container" src="images/6.png"></a></p>
</li>
</ol>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">accountadmin</span><span class="p">;</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">storage</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_integration</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">external_stage</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="n">storage_provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'azure'</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">    </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="n">azure_tenant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'9a2dkd8cb-73e9-40ee-a558-fcdnj5ef57a7'</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">        </span><span class="n">storage_allowed_locations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">            </span><span class="s1">'azure://danielwilczak.blob.core.windows.net/data'</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="c1">-- Give the sysadmin access to use the integration later.</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="k">grant</span><span class="w"> </span><span class="k">usage</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_integration</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><span class="c1">-- Get the URL to authenticate with azure and the app name to use later.</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="k">describe</span><span class="w"> </span><span class="k">storage</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_integration</span><span class="p">;</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="k">select</span><span class="w"> </span><span class="ss">"property"</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a><span class="k">case</span><span class="w">  </span><span class="k">when</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="ss">"property_value"</span><span class="p">,</span><span class="w"> </span><span class="s1">'_'</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">"property_value"</span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"property_value"</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="k">from</span><span class="w"> </span><span class="k">table</span><span class="p">(</span><span class="n">result_scan</span><span class="p">(</span><span class="n">last_query_id</span><span class="p">()))</span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="k">where</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'AZURE_CONSENT_URL'</span><span class="p">,</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="p">);</span>
</code></pre></div></td></tr></tbody></table></div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>property</th>
<th>property_value</th>
</tr>
</thead>
<tbody>
<tr>
<td>AZURE_CONSENT_URL</td>
<td>https://login.microsoftonline.com/9a2d...</td>
</tr>
<tr>
<td>AZURE_MULTI_TENANT_APP_NAME</td>
<td>c9pnugsnowflakepacint_1700096201187</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Please <strong>Ctrl+Click</strong> the URL or copy and paste it into your browser.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/12.png" data-desc-position="bottom"><img alt="Azure Approval" src="images/12.png"></a></p>
<h4 id="grant-access-in-azure">Grant Access in Azure</h4>
<p>Lets navigate to IAM so that we can give snowflake access to our storage account.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/13.png" data-desc-position="bottom"><img alt="Navigate IAM" src="images/13.png"></a></p>
<p>Search for <strong>Storage Blob Data Contributor</strong>, select the role and click next.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/14_1.png" data-desc-position="bottom"><img alt="Storage Blob Contributor" src="images/14_1.png"></a></p>
<p>Lets add the Snowflake member by selecting "select member" and search for our <strong>AZURE_MULTI_TENANT_APP_NAME</strong> that we got earlier from snowflake. </p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/15_1.png" data-desc-position="bottom"><img alt="Add snowflake memeber" src="images/15_1.png"></a></p>
<p>Once selected, click Review and Assign.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/16.png" data-desc-position="bottom"><img alt="Review and assign" src="images/16.png"></a></p>
<h3 id="load-the-data">Load the data</h3>
<details class="warning">
<summary>If you get an error when creating the stage.</summary>
<p>Just wait 5-10 minutes and try again. Sometimes it takes Azure a bit to update security.</p>
</details>
<p>Lets setup the stage, file format, warehouse and finally load some json data.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><input id="__tabbed_3_3" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Template</label><label for="__tabbed_3_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Example</label><label for="__tabbed_3_3"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2 2.75C2 1.784 2.784 1 3.75 1h2.5a.75.75 0 0 1 0 1.5h-2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 0 1.5h-2.5A1.75 1.75 0 0 1 2 13.25Zm10.44 4.5-1.97-1.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l3.25 3.25a.75.75 0 0 1 0 1.06l-3.25 3.25a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734l1.97-1.97H6.75a.75.75 0 0 1 0-1.5Z"></path></svg></span> Result</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p class="annotate"></p><div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span>
<span class="normal"><a href="#__codelineno-3-36">36</a></span>
<span class="normal"><a href="#__codelineno-3-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="n">use</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">raw</span><span class="p">;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="n">use</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="n">azure</span><span class="p">;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="n">use</span><span class="w"> </span><span class="n">warehouse</span><span class="w"> </span><span class="n">development</span><span class="p">;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="cm">/*</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="cm">   Stages are synonymous with the idea of folders</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="cm">   that can be either internal or external.</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="cm">*/</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">azure</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="n">storage_integration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">azure_integration</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'azure://&lt;STORAGE NAME&gt;.blob.core.windows.net/&lt;CONTAINER NAME&gt;'</span><span class="w"> </span><span class="cm">/* (1)! */</span><span class="w"> </span><span class="cm">/* (2)! */</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="n">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">);</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="cm">/* </span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="cm">    Create a file format so the "copy into"</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="cm">    command knows how to copy the data.</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="cm">*/</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">raw</span><span class="p">.</span><span class="n">azure</span><span class="p">.</span><span class="n">json</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'json'</span><span class="p">;</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="c1">-- Create the table to load into.</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">    </span><span class="n">file_name</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="w">    </span><span class="k">data</span><span class="w"> </span><span class="n">variant</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a><span class="p">);</span>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a><span class="c1">-- Load the json file from the json folder.</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a><span class="k">copy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">json</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="k">data</span><span class="p">)</span>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a><span class="k">from</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a><span class="w">    </span><span class="k">select</span><span class="w"> </span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a><span class="w">        </span><span class="n">metadata$filename</span><span class="p">,</span>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a><span class="w">        </span><span class="err">$</span><span class="mi">1</span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a><span class="w">    </span><span class="k">from</span>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a><span class="w">        </span><span class="o">@</span><span class="n">azure</span><span class="o">/</span><span class="n">json</span>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a><span class="w">        </span><span class="p">(</span><span class="n">file_format</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a><span class="p">);</span>
</code></pre></div></td></tr></tbody></table></div><p></p>
<ol>
<li>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/3.png" data-desc-position="bottom"><img alt="Navigate into storage account" src="images/3.png"></a></p>
</li>
<li>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/6.png" data-desc-position="bottom"><img alt="Navigate into container" src="images/6.png"></a></p>
</li>
</ol>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">use</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">raw</span><span class="p">;</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="n">use</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="n">azure</span><span class="p">;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="n">use</span><span class="w"> </span><span class="n">warehouse</span><span class="w"> </span><span class="n">development</span><span class="p">;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="cm">/*</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="cm">   Stages are synonymous with the idea of folders</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="cm">   that can be either internal or external.</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="cm">*/</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="n">azure</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">    </span><span class="n">storage_integration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">azure_integration</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">    </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'azure://danielwilczak.blob.core.windows.net/data'</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">    </span><span class="n">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">);</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="cm">/* </span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="cm">    Create a file format so the "copy into"</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="cm">    command knows how to copy the data.</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="cm">*/</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">raw</span><span class="p">.</span><span class="n">azure</span><span class="p">.</span><span class="n">json</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'json'</span><span class="p">;</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="c1">-- Create the table to load into.</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">json</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">    </span><span class="n">file_name</span><span class="w"> </span><span class="nb">varchar</span><span class="p">,</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">    </span><span class="k">data</span><span class="w"> </span><span class="n">variant</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="p">);</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a><span class="c1">-- Load the json file from the json folder.</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a><span class="k">copy</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">json</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="k">data</span><span class="p">)</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a><span class="k">from</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a><span class="w">    </span><span class="k">select</span><span class="w"> </span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a><span class="w">        </span><span class="n">metadata$filename</span><span class="p">,</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="w">        </span><span class="err">$</span><span class="mi">1</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a><span class="w">    </span><span class="k">from</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a><span class="w">        </span><span class="o">@</span><span class="n">azure</span><span class="o">/</span><span class="n">json</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a><span class="w">        </span><span class="p">(</span><span class="n">file_format</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">json</span><span class="p">)</span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a><span class="p">);</span>
</code></pre></div></td></tr></tbody></table></div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>file</th>
<th>status</th>
</tr>
</thead>
<tbody>
<tr>
<td>azure://danielwilczak.blob.core.windows.net/data/json/sample.json</td>
<td>LOADED</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Look at the data you just loaded.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"><div class="tabbed-labels"><label for="__tabbed_4_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">raw</span><span class="p">.</span><span class="n">azure</span><span class="p">.</span><span class="n">json</span><span class="p">;</span><span class="w"> </span>
</code></pre></div></td></tr></tbody></table></div>
</div>
</div>
</div>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/16_1.png" data-desc-position="bottom"><img alt="Result" src="images/16_1.png"></a></p>
<h2 id="automatic-loading">Automatic Loading  <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M7.22 6.5a.72.72 0 1 1-1.44 0 .72.72 0 0 1 1.44 0"></path><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16M4 5v3.38c.001.397.159.778.44 1.059l3.211 3.213a1.2 1.2 0 0 0 1.698 0l3.303-3.303a1.2 1.2 0 0 0 0-1.698L9.439 4.44A1.5 1.5 0 0 0 8.379 4H5a1 1 0 0 0-1 1"></path></svg></span></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you have not <a href="https://sfc-gh-dwilczak.github.io/tutorials/clouds/azure/blob/#manual-loading">manually loaded</a> data yet from azure storage. Please go back and complete that section first.</p>
</div>
<h3 id="azure_1">Azure</h3>
<p>Lets start with azure by creating a queue. All you need is a name. I've named mine <code>danielwilczak-snowflake-queue</code>. 
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/17_1.png" data-desc-position="bottom"><img alt="Create queue" src="images/17_1.png"></a></p>
<p>Store the URL. It will be used later.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/31.png" data-desc-position="bottom"><img alt="Queue" src="images/31.png"></a></p>
<p>Next lets create an event subscription. 
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/18.png" data-desc-position="bottom"><img alt="Event Subscription" src="images/18.png"></a></p>
<details class="warning">
<summary>If you get an error with the topic follow this prosess to enable it</summary>
<p>Search for subscription.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/34.png" data-desc-position="bottom"><img alt="Subscription" src="images/34.png"></a></p>
<p>Select your subscription.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/35.png" data-desc-position="bottom"><img alt="Subscription" src="images/35.png"></a></p>
<p>Search "resource provider" and select it.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/36.png" data-desc-position="bottom"><img alt="Subscription" src="images/36.png"></a></p>
<p>Search "EventGrid", select it, and the select register. This will enable it in your account.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/37.png" data-desc-position="bottom"><img alt="Subscription" src="images/37.png"></a></p>
<p>Wait for it to say registered.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/38.png" data-desc-position="bottom"><img alt="Subscription" src="images/38.png"></a></p>
</details>
<p>Enter in the highlighted fields. I've named mine <code>danielwilczak-snowflake-event</code>. Once entered click "configure endpoint".
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/19.png" data-desc-position="bottom"><img alt="Event Input" src="images/19.png"></a></p>
<p>Enter the storage account and selct your queue that we setup prior.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/20.png" data-desc-position="bottom"><img alt="Event Input" src="images/20.png"></a></p>
<p>To finish the event, click "create".
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/21.png" data-desc-position="bottom"><img alt="Create" src="images/21.png"></a></p>
<p>Result
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/32.png" data-desc-position="bottom"><img alt="Create" src="images/32.png"></a></p>
<h3 id="snowflake_1">Snowflake</h3>
<p>Open a worksheet and enter in your <code>queue url</code> and <code>tenant_id</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"><input id="__tabbed_5_2" name="__tabbed_5" type="radio"><input id="__tabbed_5_3" name="__tabbed_5" type="radio"><div class="tabbed-labels"><label for="__tabbed_5_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Template</label><label for="__tabbed_5_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> Example</label><label for="__tabbed_5_3"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2 2.75C2 1.784 2.784 1 3.75 1h2.5a.75.75 0 0 1 0 1.5h-2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 0 1.5h-2.5A1.75 1.75 0 0 1 2 13.25Zm10.44 4.5-1.97-1.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l3.25 3.25a.75.75 0 0 1 0 1.06l-3.25 3.25a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734l1.97-1.97H6.75a.75.75 0 0 1 0-1.5Z"></path></svg></span> Result</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p class="annotate"></p><div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">accountadmin</span><span class="p">;</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="c1">-- Setup the storage notification to know when storage events happen.</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_snowpipe_integration</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">    </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">queue</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">    </span><span class="n">notification_provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">azure_storage_queue</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">    </span><span class="n">azure_storage_queue_primary_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;QUEUE URL&gt;'</span><span class="w"> </span><span class="cm">/* (1)! */</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">    </span><span class="n">azure_tenant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;TENANT ID&gt;'</span><span class="p">;</span><span class="w"> </span><span class="cm">/* (2)! */</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="c1">-- Give the sysadmin access to use the integration.</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="k">grant</span><span class="w"> </span><span class="k">usage</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_snowpipe_integration</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="k">describe</span><span class="w"> </span><span class="k">storage</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_integration</span><span class="p">;</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="k">select</span><span class="w"> </span><span class="ss">"property"</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="k">case</span><span class="w">  </span><span class="k">when</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="ss">"property_value"</span><span class="p">,</span><span class="w"> </span><span class="s1">'_'</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">"property_value"</span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"property_value"</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="k">from</span><span class="w"> </span><span class="k">table</span><span class="p">(</span><span class="n">result_scan</span><span class="p">(</span><span class="n">last_query_id</span><span class="p">()))</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="k">where</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'AZURE_CONSENT_URL'</span><span class="p">,</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="p">);</span>
</code></pre></div></td></tr></tbody></table></div><p></p>
<ol>
<li>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/22.png" data-desc-position="bottom"><img alt="Queue URL" src="images/22.png"></a></p>
</li>
<li>
<p>Using the search bar, look up <strong>tenant properties</strong>.
    <a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/9.png" data-desc-position="bottom"><img alt="Tenant Properties" src="images/9.png"></a></p>
<p>Copy your <strong>Tenant ID</strong>.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/10.png" data-desc-position="bottom"><img alt="Tenant Properties" src="images/10.png"></a></p>
</li>
</ol>
</div>
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">accountadmin</span><span class="p">;</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="c1">-- Setup the storage notification to know when storage events happen.</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_snowpipe_integration</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="n">enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">queue</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">    </span><span class="n">notification_provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">azure_storage_queue</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">    </span><span class="n">azure_storage_queue_primary_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'https://danielwilczak.queue.core.windows.net/danielwilczak-snowflake-queue'</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">    </span><span class="n">azure_tenant_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'9a2d78cb-73e9-40ee-a558-fc1adfff57a7'</span><span class="p">;</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="c1">-- Give the sysadmin access to use the integration.</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="k">grant</span><span class="w"> </span><span class="k">usage</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_snowpipe_integration</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="k">describe</span><span class="w"> </span><span class="n">notification</span><span class="w"> </span><span class="n">integration</span><span class="w"> </span><span class="n">azure_snowpipe_integration</span><span class="p">;</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="k">select</span><span class="w"> </span><span class="ss">"property"</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="k">case</span><span class="w">  </span><span class="k">when</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="ss">"property_value"</span><span class="p">,</span><span class="w"> </span><span class="s1">'_'</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="ss">"property_value"</span><span class="k">end</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">"property_value"</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="k">from</span><span class="w"> </span><span class="k">table</span><span class="p">(</span><span class="n">result_scan</span><span class="p">(</span><span class="n">last_query_id</span><span class="p">()))</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="k">where</span><span class="w"> </span><span class="ss">"property"</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="s1">'AZURE_CONSENT_URL'</span><span class="p">,</span><span class="w"> </span><span class="s1">'AZURE_MULTI_TENANT_APP_NAME'</span><span class="p">);</span>
</code></pre></div></td></tr></tbody></table></div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>property</th>
<th>PROPERTY_VALUE</th>
</tr>
</thead>
<tbody>
<tr>
<td>AZURE_CONSENT_URL</td>
<td>https://login.microsoftonline.com/9a2d7...</td>
</tr>
<tr>
<td>AZURE_MULTI_TENANT_APP_NAME</td>
<td>tzpbnzsnowflakepacint_1700112906001</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Please ctrl+click the url or enter it into your browser you will have to accept the integration on azure. 
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/24.png" data-desc-position="bottom"><img alt="Accept Integration" src="images/24.png"></a></p>
<h4 id="grant-access-in-azure_1">Grant Access in Azure</h4>
<p>Using the left side search "iam" and select Access Control and "add role assignment".
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/25.png" data-desc-position="bottom"><img alt="Navigate to role" src="images/25.png"></a></p>
<p>Search for "storage queue data contributor" and select it and click next.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/26.png" data-desc-position="bottom"><img alt="NRole assignment" src="images/26.png"></a></p>
<p>Click "Select members" and add your <code>AZURE_MULTI_TENANT_APP_NAME</code> that we recieved from Snowflake in the prior snowflake step. 
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/27.png" data-desc-position="bottom"><img alt="NRole assignment" src="images/27.png"></a></p>
<p>Final Azure step, select review and assign and your done with azure.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/27.png" data-desc-position="bottom"><img alt="NRole assignment" src="images/27.png"></a></p>
<h3 id="load-the-data_1">Load the data</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes it may take 1-2 minutes before you see data in the table. This depends on how Azure is feeling today.</p>
</div>
<details class="warning">
<summary>If you get an error when creating the pipe.</summary>
<p>Just wait 5-10 minutes. Sometimes it takes Azure a bit to update security.</p>
</details>
<p>We'll load a csv file by automating the creation of the table and infering the names in the csv pipe.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio"><input id="__tabbed_6_2" name="__tabbed_6" type="radio"><div class="tabbed-labels"><label for="__tabbed_6_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M16 13.25A1.75 1.75 0 0 1 14.25 15H1.75A1.75 1.75 0 0 1 0 13.25V2.75C0 1.784.784 1 1.75 1h12.5c.966 0 1.75.784 1.75 1.75ZM1.75 2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h.94l.03-.03 6.077-6.078a1.75 1.75 0 0 1 2.412-.06L14.5 10.31V2.75a.25.25 0 0 0-.25-.25Zm12.5 11a.25.25 0 0 0 .25-.25v-.917l-4.298-3.889a.25.25 0 0 0-.344.009L4.81 13.5ZM7 6a2 2 0 1 1-3.999.001A2 2 0 0 1 7 6M5.5 6a.5.5 0 1 0-1 0 .5.5 0 0 0 1 0"></path></svg></span> SQL</label><label for="__tabbed_6_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2 2.75C2 1.784 2.784 1 3.75 1h2.5a.75.75 0 0 1 0 1.5h-2.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25h2.5a.75.75 0 0 1 0 1.5h-2.5A1.75 1.75 0 0 1 2 13.25Zm10.44 4.5-1.97-1.97a.749.749 0 0 1 .326-1.275.75.75 0 0 1 .734.215l3.25 3.25a.75.75 0 0 1 0 1.06l-3.25 3.25a.749.749 0 0 1-1.275-.326.75.75 0 0 1 .215-.734l1.97-1.97H6.75a.75.75 0 0 1 0-1.5Z"></path></svg></span> Result</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-8-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-8-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-8-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-8-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-8-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-8-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-8-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-8-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-8-10">10</a></span>
<span class="normal"><a href="#__codelineno-8-11">11</a></span>
<span class="normal"><a href="#__codelineno-8-12">12</a></span>
<span class="normal"><a href="#__codelineno-8-13">13</a></span>
<span class="normal"><a href="#__codelineno-8-14">14</a></span>
<span class="normal"><a href="#__codelineno-8-15">15</a></span>
<span class="normal"><a href="#__codelineno-8-16">16</a></span>
<span class="normal"><a href="#__codelineno-8-17">17</a></span>
<span class="normal"><a href="#__codelineno-8-18">18</a></span>
<span class="normal"><a href="#__codelineno-8-19">19</a></span>
<span class="normal"><a href="#__codelineno-8-20">20</a></span>
<span class="normal"><a href="#__codelineno-8-21">21</a></span>
<span class="normal"><a href="#__codelineno-8-22">22</a></span>
<span class="normal"><a href="#__codelineno-8-23">23</a></span>
<span class="normal"><a href="#__codelineno-8-24">24</a></span>
<span class="normal"><a href="#__codelineno-8-25">25</a></span>
<span class="normal"><a href="#__codelineno-8-26">26</a></span>
<span class="normal"><a href="#__codelineno-8-27">27</a></span>
<span class="normal"><a href="#__codelineno-8-28">28</a></span>
<span class="normal"><a href="#__codelineno-8-29">29</a></span>
<span class="normal"><a href="#__codelineno-8-30">30</a></span>
<span class="normal"><a href="#__codelineno-8-31">31</a></span>
<span class="normal"><a href="#__codelineno-8-32">32</a></span>
<span class="normal"><a href="#__codelineno-8-33">33</a></span>
<span class="normal"><a href="#__codelineno-8-34">34</a></span>
<span class="normal"><a href="#__codelineno-8-35">35</a></span>
<span class="normal"><a href="#__codelineno-8-36">36</a></span>
<span class="normal"><a href="#__codelineno-8-37">37</a></span>
<span class="normal"><a href="#__codelineno-8-38">38</a></span>
<span class="normal"><a href="#__codelineno-8-39">39</a></span>
<span class="normal"><a href="#__codelineno-8-40">40</a></span>
<span class="normal"><a href="#__codelineno-8-41">41</a></span>
<span class="normal"><a href="#__codelineno-8-42">42</a></span>
<span class="normal"><a href="#__codelineno-8-43">43</a></span>
<span class="normal"><a href="#__codelineno-8-44">44</a></span>
<span class="normal"><a href="#__codelineno-8-45">45</a></span>
<span class="normal"><a href="#__codelineno-8-46">46</a></span>
<span class="normal"><a href="#__codelineno-8-47">47</a></span>
<span class="normal"><a href="#__codelineno-8-48">48</a></span>
<span class="normal"><a href="#__codelineno-8-49">49</a></span>
<span class="normal"><a href="#__codelineno-8-50">50</a></span>
<span class="normal"><a href="#__codelineno-8-51">51</a></span>
<span class="normal"><a href="#__codelineno-8-52">52</a></span>
<span class="normal"><a href="#__codelineno-8-53">53</a></span>
<span class="normal"><a href="#__codelineno-8-54">54</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="n">use</span><span class="w"> </span><span class="k">role</span><span class="w"> </span><span class="n">sysadmin</span><span class="p">;</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">use</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="n">raw</span><span class="p">;</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="n">use</span><span class="w"> </span><span class="k">schema</span><span class="w"> </span><span class="n">azure</span><span class="p">;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="n">use</span><span class="w"> </span><span class="n">warehouse</span><span class="w"> </span><span class="n">development</span><span class="p">;</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="cm">/*</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="cm">    Copy CSV data using a pipe without having</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="cm">    to write out the column names.</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="cm">*/</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="n">infer</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">csv</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">    </span><span class="n">parse_header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">    </span><span class="n">skip_blank_lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">    </span><span class="n">field_optionally_enclosed_by</span><span class="w"> </span><span class="o">=</span><span class="s1">'"'</span>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="w">    </span><span class="n">trim_space</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
<a id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="w">    </span><span class="n">error_on_column_count_mismatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<a id="__codelineno-8-17" name="__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18"></a><span class="cm">/*</span>
<a id="__codelineno-8-19" name="__codelineno-8-19"></a><span class="cm">    Creat the table with the column names</span>
<a id="__codelineno-8-20" name="__codelineno-8-20"></a><span class="cm">    generated for us.</span>
<a id="__codelineno-8-21" name="__codelineno-8-21"></a><span class="cm">*/</span>
<a id="__codelineno-8-22" name="__codelineno-8-22"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">csv</span>
<a id="__codelineno-8-23" name="__codelineno-8-23"></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="k">template</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-8-24" name="__codelineno-8-24"></a><span class="w">        </span><span class="k">select</span><span class="w"> </span><span class="n">array_agg</span><span class="p">(</span><span class="n">object_construct</span><span class="p">(</span><span class="o">*</span><span class="p">))</span>
<a id="__codelineno-8-25" name="__codelineno-8-25"></a><span class="w">        </span><span class="n">within</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="p">(</span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">order_id</span><span class="p">)</span>
<a id="__codelineno-8-26" name="__codelineno-8-26"></a><span class="w">        </span><span class="k">from</span><span class="w"> </span><span class="k">table</span><span class="p">(</span>
<a id="__codelineno-8-27" name="__codelineno-8-27"></a><span class="w">            </span><span class="n">infer_schema</span><span class="p">(</span><span class="w">        </span>
<a id="__codelineno-8-28" name="__codelineno-8-28"></a><span class="w">            </span><span class="k">LOCATION</span><span class="o">=&gt;</span><span class="s1">'@azure/csv'</span>
<a id="__codelineno-8-29" name="__codelineno-8-29"></a><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">file_format</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'infer'</span><span class="p">)</span>
<a id="__codelineno-8-30" name="__codelineno-8-30"></a><span class="w">        </span><span class="p">)</span>
<a id="__codelineno-8-31" name="__codelineno-8-31"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-8-32" name="__codelineno-8-32"></a>
<a id="__codelineno-8-33" name="__codelineno-8-33"></a><span class="cm">/*</span>
<a id="__codelineno-8-34" name="__codelineno-8-34"></a><span class="cm">    Load the data and assign the pipe notification</span>
<a id="__codelineno-8-35" name="__codelineno-8-35"></a><span class="cm">    to know when a file is added.</span>
<a id="__codelineno-8-36" name="__codelineno-8-36"></a><span class="cm">*/</span>
<a id="__codelineno-8-37" name="__codelineno-8-37"></a><span class="k">create</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">replace</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="n">csv</span><span class="w"> </span>
<a id="__codelineno-8-38" name="__codelineno-8-38"></a><span class="w">    </span><span class="n">auto_ingest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="w"> </span>
<a id="__codelineno-8-39" name="__codelineno-8-39"></a><span class="w">    </span><span class="n">integration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'AZURE_SNOWPIPE_INTEGRATION'</span><span class="w"> </span>
<a id="__codelineno-8-40" name="__codelineno-8-40"></a><span class="w">    </span><span class="k">as</span>
<a id="__codelineno-8-41" name="__codelineno-8-41"></a>
<a id="__codelineno-8-42" name="__codelineno-8-42"></a><span class="w">    </span><span class="k">COPY</span><span class="w"> </span><span class="k">into</span>
<a id="__codelineno-8-43" name="__codelineno-8-43"></a><span class="w">        </span><span class="n">csv</span>
<a id="__codelineno-8-44" name="__codelineno-8-44"></a><span class="w">    </span><span class="k">from</span>
<a id="__codelineno-8-45" name="__codelineno-8-45"></a><span class="w">        </span><span class="o">@</span><span class="n">azure</span><span class="o">/</span><span class="n">csv</span>
<a id="__codelineno-8-46" name="__codelineno-8-46"></a>
<a id="__codelineno-8-47" name="__codelineno-8-47"></a><span class="w">    </span><span class="n">file_format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">format_name</span><span class="o">=</span><span class="w"> </span><span class="s1">'infer'</span><span class="p">)</span>
<a id="__codelineno-8-48" name="__codelineno-8-48"></a><span class="w">    </span><span class="n">match_by_column_name</span><span class="o">=</span><span class="n">case_insensitive</span><span class="p">;</span>
<a id="__codelineno-8-49" name="__codelineno-8-49"></a>
<a id="__codelineno-8-50" name="__codelineno-8-50"></a><span class="cm">/* </span>
<a id="__codelineno-8-51" name="__codelineno-8-51"></a><span class="cm">    Refresh the state of the pipe to make</span>
<a id="__codelineno-8-52" name="__codelineno-8-52"></a><span class="cm">    sure it's updated with all files.</span>
<a id="__codelineno-8-53" name="__codelineno-8-53"></a><span class="cm">*/</span>
<a id="__codelineno-8-54" name="__codelineno-8-54"></a><span class="k">alter</span><span class="w"> </span><span class="n">pipe</span><span class="w"> </span><span class="n">csv</span><span class="w"> </span><span class="n">refresh</span><span class="p">;</span>
</code></pre></div></td></tr></tbody></table></div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>File</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>/sample_1.csv</td>
<td>SENT</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h3 id="result">Result</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sometimes it may take 1-2 minutes before you see data in the table. This depends on how Azure is feeling today.</p>
</div>
<p>Lets add more <a href="https://sfc-gh-dwilczak.github.io/tutorials/data/csv/sample_2.csv">sample data</a> into the azure csv folder and see it added in snowflake ~30 seconds later. We can see this by doing a count on our table and see 20 records where th original csv only has 10 records.</p>
<iframe width="850px" height="478px" src="https://www.youtube.com/embed/ZBr6gKOFvw4?si=MfWVGshDNIy3RAtE" style="display:block;" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.select", "content.code.copy", "content.action.edit", "content.action.view", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.26099bd0.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.9d1edc04.min.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>